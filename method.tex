% !TEX root = thesis.tex

%%
%%
%% Method chapter
%%
%%

In this chapter, we describe the methods used to examine the statistical performance of the \gls{dkd}.
The basic unit is the \textit{experiment}, a set of simulations run with the same initial setup with the same measurements taken.
There is a fixed setup for each experiment, with the following set of parameters.
\begin{table}[htbp]
    \centering
    \begin{tabular}{ll}
    Parameter name & Description \\
    \hline
    x1.min & Minimum value of the study area in the horizontal (\(X_1\)) direction \\
    x1.max & Maximum value of the study area in the horizontal (\(X_1\)) direction  \\
    x2.min & Minimum value of the study area in the vertical (\(X_2\)) direction \\
    x2.max & Maximum value of the study area in the vertical (\(X_2\)) direction \\
    grid.by & Space between grid points in the study area \\
    buffer & Buffer around outside of study area \\
    N.p & Size of population \\
    EN.i & Expected number of incidents per simulation \\
    c1 & (optional) \(X_1\) coordinate of the population peak \\
    c2 & (optional) \(X_2\) coordinate of the population peak \\
    sigma1 & (optional) \(X_1\) standard deviation of the population peak \\
    sigma2 & (optional) \(X_2\) standard deviation of the population peak \\
    rho & (optional) Correlation coefficient of \(X_1\) and \(X_2\) \\
    bandwidths & List of bandwidths for evaluating the Oracle \\
    incident\textunderscore rate & Risk function for generating incidents from population \\
    \end{tabular}
    \caption{Experimental parameters}
    \label{tab:experimental_parameters}
\end{table}

\Cref{sec:method:experiment_structure} describes the steps of each experiment, together with the measurements taken.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%
%% Section: accuracy measures
%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Measuring of accuracy of the DKD}
\label{sec:method:accuracy}

In order to describe the accuracy of the \gls{dkd} as a method of estimating the true risk function \(\lambda\),
we use several accuracy measures.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Subsection: MISE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{MISE}
\label{subsec:method:MISE}

\Gls{mise} is a measure of the expected squared difference between an estimated risk function \gls{lambda_hat},
computed using the \gls{dkd}, and the true risk function \gls{lambda}.
\Gls{mise} allows for additional analysis by being broken down into the mean integraged bias and mean integrated variance.
It can also be easily approximated by cross-validation error.

For any given data sample, we can use the \gls{dkd} to compute the estimated risk function \gls{lambda_hat}.
We then integrate the squared error in the estimate over the plane to obtain the \gls{ise}.

\begin{equation}
    \mbox{ISE} = \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} \left( \hat{\lambda} - \lambda \right)^2 \diff{X_2} \diff{X_1}
\end{equation}

We can then compute the expected value of the \gls{ise} to obtain the \gls{mise}.

\begin{equation}
    \mbox{MISE} = \E [\mbox{ISE}]
\end{equation}

In our experiments, we run \(M\) monte carlo simulations, and estimate the \gls{mise} by taking the empirical average of the \glspl{ise}.

\begin{equation}
    \hat{\mbox{MISE}} = \frac{1}{M} \sum_{i=1}^{M} \mbox{ISE}_i
\end{equation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Subsection: MIAE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{MIAE}
\label{subsec:method:MIAE}

\Gls{miae} is a measure of the expected absolute difference between an estimated risk function \gls{lambda_hat},
computed using the \gls{dkd}, and the true risk function \gls{lambda}.
\Gls{miae} differs from \gls{mise} by on the one hand providing a more intuitive comparison,
since we are comparing the absolute difference instead of the squared difference.
On the other hand, it lacks some of the nice mathematical properties of the \gls{mise}.

As we did in \autoref{subsec:method:MISE}, for any given data sample we use the \gls{dkd} to compute the estimated risk function \gls{lambda_hat}.
We then integrate the absolute value of the error in the estimate over the plane to obtain the \gls{ise}.

\begin{equation}
    \mbox{IAE} = \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} \left| \hat{\lambda} - \lambda \right| \diff{X_2} \diff{X_1}
\end{equation}

We can then compute the expected value of the \gls{ise} to obtain the \gls{mise}.

\begin{equation}
    \mbox{MIAE} = \E [\mbox{IAE}]
\end{equation}

As above, we run \(M\) monte carlo simulations, and estimate the \gls{miae} by taking the empirical average of the \glspl{iae}.

\begin{equation}
    \hat{\mbox{MIAE}} = \frac{1}{M} \sum_{i=1}^{M} \mbox{IAE}_i
\end{equation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%
%% Section: experiment structure
%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Experiment structure}
\label{sec:method:experiment_structure}

In order to ensure repeatability of the experiements, we begin by setting the random number seed to the same fixed value (12).

The first step in each experimental run is to define the study area. 
The study area is always a 2-dimensional rectangle, with coordinates in the \(X_1\) and \(X_2\) directions set using the parameters \textit{x1.min}, \textit{x1.max}, \textit{x2.min}, and \textit{x2.max}.
The study area is further restricted by the \textit{buffer} parameter.

Next, a population is generated of size \textit{N.p}.
When the \textit{c1} and \textit{c2} parameters are given, the population is distributed according to the parameters above.
In particular, the distribution has bivariate normal shape with center (\textit{c1}, \textit{c2}),
standard deviations \textit{sigma1}, \textit{sigma2}, and correlation \textit{rho}.

Next, we adjust the incident rate function, \textit{incident\textunderscore rate} parameter, by scaling it so that the expected number of incidents is equal to the \textit{EN.i} parameter.
Assuming the expected number of incidents generate by \textit{incident\textunderscore rate} by itself is 1, we have

\[
    R(\vec{x}) = \mbox{EN.i}~\times~\mbox{incident\textunderscore rate}(\vec{x}) \text{,}
\]

and we call \(R(\vec{x}\) is the \textit{true incident rate} for the experiment.

\section{Verifying bandwidth selection dependency on size}

\section{Examining multiplication factor impact on error measures}

\section{Examining sample size impact on error measures}

\section{Examining decay rate of the risk function on error measures}

\section{Examining decay rate of the population on error measures}

\section{Examining two peaks of the risk function}

\section{Examining non-uniform population distrbution}